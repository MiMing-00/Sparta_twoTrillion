<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./css/reset.css" rel="stylesheet" type="text/css" />
    <title>ìµœí˜œë¯¸ í”„ë¡œí•„</title>
</head>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap');


    .noto-sans-kr-myclass {
        font-family: "Noto Sans KR", sans-serif;
        font-optical-sizing: auto;
        font-weight: normal;
        /* ì›í•˜ëŠ” font-weight ê°’ìœ¼ë¡œ ë³€ê²½ */
        font-style: normal;
    }

    body {
        background-image: url(./img/chmBgImg.jpg);
        background-size: cover;
        background-repeat: no-repeat;
    }

    ::selection {
            background-color: #7B66FF;
            color: #fff;
        }

    .leftBox,
    .rightBox,
    .commentList,
    .commentForm {
    opacity: 0;
    animation: fadeIn 1s forwards;
}

@keyframes fadeIn {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 1;
    }
}

    .memberBox {
        box-sizing: border-box;
        width: 1440px;
        border: none;
        margin: 100px auto 0;
        display: flex;
        gap: 40px;
        justify-content: center;
    }

    .leftBox,
    .rightBox {
        border: 3px solid #81E5C9;
        border-radius: 50px;
        background-color: rgb(255,255,255,0.6);
        ;
    }

    .leftBox {
        width: 900px;
        padding: 60px;
        animation-delay: 0.2s;
    }

    .leftBox>.leftTitle {
        display: flex;
        justify-content: center;
        margin: 70px auto 100px auto;
    }

    .leftBox {
        font-size: 32px;
    }

    .leftBox .myProfile {
        margin: 20px;
        font-size: 20px;
        margin-bottom: 50px;
    }

    .myProfile {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .myProfile>div {
        margin-bottom: 20px;
    }

    .blogLink {
        margin-top: 50px;
    }

    .vel:hover {
        background: silver;
    }

    .hub123:hover {
        background: silver;
    }

    .blogLink a {
        width: max-content;
        margin: auto 20px auto auto;
        border: none;
        border-radius: 20px;
        background-color: #7F98F8;
        padding: 10px;
        margin: 20px 15px auto 5px;
        font-size: 20px;
        color: white;
    }

    .leftBox .myProfile>div+div {
        margin-top: 20px;
    }

    .leftBox .myProfile>div>.title {
        margin-bottom: 10px;
        font-weight: bold;
    }

    .rightBox {
        width: 500px;
        padding: 60px;
        text-align: center;
        display: flex;
        justify-content: center;
        flex-direction: column;
        animation-delay: 0.8s;
    }

    .rightBoxImg {
        width: 400px;
        height: 400px;
        margin: 0 auto;
        background-image: url(./img/memImgChm.png);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
    }

    .rightBoxTxt {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .rightBoxTxt>p {
        font-size: 24px;
    }

    .rightBoxTxt>p+p {
        margin-top: 30px;
    }

    .backBtn {
        position: fixed;
        left: 20px;
        top: 20px;
        width: 50px;
        height: 50px;
        background-image: url(./img/backBtnChm.png?ver=24);
        background-size: contain;
        cursor: pointer;
    }

    .commentList {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 30px;
        width: 1440px;
        margin: 30px auto;
        border: 3px solid #ADBDFB;
        border-radius: 20px;
        font-size: 18px;
        box-sizing: border-box;
        animation-delay: 1s;
    }

    .commentList>h3 {
        margin-bottom: 20px;
    }

    .userComment {
        line-height: 20px;
        border-radius: 1px;
    }

    .commentNickPw {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
    }

    .nickname {
        font-size: 18px;
        font-weight: 550;
    }

    .pw {
        font-size: 18px;
        font-weight: 550;
    }

    .comment {
        width: 100%;
        border-style: solid;
        border-radius: 20px;
        font-size: 18px;
        font-weight: 450;
    }

    .commentLi {
        border: 1px solid #7B66FF;
        border-radius: 20px;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        margin: 20px;
    }


    .commentLi+.commentLi {
        margin-top: 10px;
    }

    .commentForm {
        background-color: white;
        width: 1440px;
        border: 3px solid rgb(144, 198, 239);
        border-radius: 20px;
        box-sizing: border-box;
        padding: 60px;
        margin: 0 auto;
        animation-delay: 1.5s;
    }

    #like {
        width: 25px;
        fill: red;
    }

    #like:hover {
        fill: green;
        cursor: pointer;
    }

    #likeNum {
        color: grey;
    }

    .commentUp {
        display: flex;
        gap: 20px;
    }

    .delBtn {
        margin: 5px;
    }

    .modiBtn {
        margin: 5px;
    }

    .liRight {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .liRight button {
        font-family: "Noto Sans KR", sans-serif;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;

        font-weight: 500;
    }

    .liLeft>p {
        margin: 10px;
    }

    .button {
        display: inline-block;
        position: relative;
        width: 240px;
        height: 60px;

        border-radius: 27px;
        font-size: 100%;

        color: white;
        letter-spacing: 0.05em;
        text-align: center;
        text-decoration: none;
        text-transform: uppercase;
    }

    .button .inner {
        position: relative;
        z-index: 2;
    }

    .button canvas {
        position: absolute;
        top: -50px;
        right: -50px;
        bottom: -50px;
        left: -50px;

        z-index: 1;
    }

    #comment {
        margin-top: 10px;
    }

    .ninini {
        font-weight: bold;
    }

</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="module">
    // Firebase SDK ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    import { getDocs, getDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    import { doc, setDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    import { deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    // Firebase êµ¬ì„± ì •ë³´ ì„¤ì •
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional

    // const firebaseConfig = {
    //     apiKey: "",
    //     authDomain: "",
    //     projectId: "",
    //     storageBucket: "",
    //     messagingSenderId: "",
    //     appId: "",
    //     measurementId: ""
    // };

    // Firebase ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™”
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ëŒ“ê¸€ ë“±ë¡
    $("#postingBtn").click(async function () {
        let nickname = $('#nickname').val();
        let pw = $('#pw').val();
        let comment = $('#comment').val();

        if (!nickname || !pw || !comment) {
            alert('ë‹‰ë„¤ì„, ë¹„ë°€ë²ˆí˜¸, ëŒ“ê¸€ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return; //
        }
        const commentId = Date.now().toString()

        const data = {
            'nickname': nickname,
            'pw': pw,
            'comment': comment,
        };
        
        await setDoc(doc(db, "webComments", commentId), data);
        alert('ëŒ“ê¸€ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
        window.location.reload();
    });

    let docs = await getDocs(collection(db, "webComments"));
    docs.forEach((doc) => {
        let row = doc.data();
        let nickname = row['nickname'];
        let pw = row['pw'];
        let comment = row['comment'];
        let id = doc.id;

        let temp_html = `            
        <li class="commentLi">
            <div class="liLeft">
                    <p class= "ninini">${nickname}</p>
                    <p>${comment}</p>
            </div>
            <div class="liRight">
                    <button type="button" class="modiBtn" data-id = "${id}" style="float: right;">ìˆ˜ì •</button>
                    <button type="button" class="delBtn" data-id = "${id}" style="float: right;">ì‚­ì œ</button>
                    <svg xmlns="http://www.w3.org/2000/svg" id="like" class="like"
                        viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" />
                    </svg>
                    <p id="likeNum">0</p>
                </div>

        </li>`
        $('.userComment').append(temp_html);
    });

    const heartBtn = document.querySelectorAll('.like')
    heartBtn.forEach((target) => target.addEventListener('click', function () {
        target.classList.toggle('active')
        const likeNum = target.nextElementSibling;
        likeNum.innerText = +likeNum.innerText + 1
    }))

    // ëŒ“ê¸€ ì‚­ì œ
    async function clickDeleteBtn(event) {
        const id = event.target.dataset.id

        const needPwdel = prompt("ëŒ“ê¸€ì„ ì‚­ì œí•˜ë ¤ë©´ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.", "");
        if (needPwdel === null) {
            alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
            return;
        }

        const comment = await getDoc(doc(db, "webComments", id));
        const data = comment.data();

        if (data.pw === needPwdel) {
            await deleteDoc(doc(db, "webComments", id));
            alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
            window.location.reload();
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë‹¤ë¦…ë‹ˆë‹¤.");
        }
    }

    // ì‚­ì œ ë²„íŠ¼ ëˆ„ë¥´ë©´ ì‹¤í–‰
    document.querySelectorAll(".delBtn").forEach((item) => {
        item.addEventListener("click", clickDeleteBtn);
    });

    // ëŒ“ê¸€ ìˆ˜ì • promt 2ì¤‘ ì„¤ê³„
    async function clickModifyBtn(event) {
        const id = event.target.dataset.id;

        const needPwModi = prompt("ìˆ˜ì •í•˜ë ¤ë©´ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.", "");
        if (needPwModi === null) {
            alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
            return;
        }

        const commentDoc = await getDoc(doc(db, "webComments", id));

        const data = commentDoc.data();
        if (data.pw === needPwModi) {
            const newComment = prompt("ìˆ˜ì •í•  ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.", data.comment);
            if (newComment === null) {
                alert("ëŒ“ê¸€ì´ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
                return;
            }
            await updateDoc(doc(db, "webComments", id), {
                'comment': newComment
            });
            window.location.reload();
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë‹¤ë¦…ë‹ˆë‹¤.");
        }
    }

    // ìˆ˜ì • ë²„íŠ¼ ëˆ„ë¥´ë©´ ì‹¤í–‰
    document.querySelectorAll(".modiBtn").forEach((item) => {
        item.addEventListener("click", clickModifyBtn);
    });

</script>

<body class="noto-sans-kr-myclass">
    <a href="index.html">
        <div class="backBtn"></div>
    </a>
    <div class="memberBox">
        <div class="leftBox">
            <div class="leftTitle">
                <ì—°ë´‰ 2ì¡°> ìµœí˜œë¯¸ í”„ë¡œí•„
            </div>
            <div class="myProfile">
                <div class="Advantages">
                    <p class="title">ê°ê´€ì ì¸ ìì‹ ì˜ ì¥ì </p>
                    <p> ì¶”ì§„ë ¥ê³¼ ì„±ì‹¤í•¨</p>
                </div>
                <div class="myStyle">
                    <p class="title">ìì‹ ì˜ ìŠ¤íƒ€ì¼</p>
                    <p>ì „ì²´ì ì¸ í° ê·¸ë¦¼ì„ ê·¸ë¦° ì´í›„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="collaboStyle">
                    <p class="title">í˜‘ë ¥ ìŠ¤íƒ€ì¼</p>
                    <p>íŒ€ì›ë“¤ì˜ ì˜ê²¬ì„ ì „ë¶€ ë‹¤ ë“£ê³  ì¡°ìœ¨í•˜ëŠ” ê²ƒì„ ì¶”êµ¬í•©ë‹ˆë‹¤.</br>ì´ë²ˆ í”„ë¡œì íŠ¸ ëŒ€ë°• ê¸°ì›í•©ë‹ˆë‹¤ !</p>
                </div>
                <div class="blogLink">
                    <a href="https://velog.io/@miming-00" class="vel"> ë²¨ë¡œê·¸</a>
                    <a href="https://github.com/MiMing-00" class="hub123"> ê¹ƒí—ˆë¸Œ </a>
                </div>
            </div>
        </div>
        <div class="rightBox">
            <div class="rightBoxImg">
            </div>
            <div class="rightBoxTxt">
                <p>ìµœí˜œë¯¸</p>
                <p>ENTJ</p>
                <p>ì¤‘êº¾ê·¸ë§ˆë¥¼ ì•„ì‹­ë‹ˆê¹Œ? </p>
                <p>ì¤‘ìš”í•œ ê±´ êº¾ì—¬ë„ <span style="font-weight: bold">ê·¸ëƒ¥</span> í•˜ëŠ” ë§ˆìŒ...ğŸ˜Œ</p>
            </div>
        </div>
    </div>
    <div class="commentList">
        <h3>ëŒ“ê¸€ ëª©ë¡</h3>
        <ul class="userComment">
            <li class="commentLi">
                <div class="liLeft">
                    <p>íŒŒì´ì–´ë² ì´ìŠ¤ ì—°ë™ì„ ë©ˆì·„ìŠµë‹ˆë‹¤.</p>
                    <p>ëŒ“ê¸€ ê¸°ëŠ¥ì„ ì ì‹œ ë§‰ì•„ë‘ì—ˆìŠµë‹ˆë‹¤.</p>
                    <div class="liRight">
                        <button type="button" class="delBtn" style="float: right;">ì‚­ì œ</button>
                        <button type="button" class="modiBtn" style="float: right;">ìˆ˜ì •</button>
                        <svg xmlns="http://www.w3.org/2000/svg" id="like" class="like" viewBox="0 0 512 512">
                            <path
                                d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" />
                        </svg>
                        <p id="likeNum">12</p>
                    </div>
            </li>
            <!-- <li class="commentLi">
                <div class="moddelBtn">
                    <button type="button" class="delBtn" style="float: right;">ì‚­ì œ</button>
                    <button type="button" class="modiBtn" style="float: right;">ìˆ˜ì •</button>
                </div>
                <p>ê¹€íœ˜ì§„</p>
                <p>ì¹œí•´ì§€ê³  ì‹¶ì–´ìš” ã… ã… </p>
            </li>
            <li class="commentLi">
                <div class="moddelBtn">
                    <button type="button" class="delBtn" style="float: right;">ì‚­ì œ</button>
                    <button type="button" class="modiBtn" style="float: right;">ìˆ˜ì •</button>
                </div>
                <p>ìµœí˜œë¯¸</p>
                <p>ì¸ìŠ¤íƒ€ ì•„ì´ë”” ì•Œë ¤ì£¼ì„¸ìš”</p>
            </li>
            <li class="commentLi">
                <div class="moddelBtn">
                    <button type="button" class="delBtn" style="float: right;">ì‚­ì œ</button>
                    <button type="button" class="modiBtn" style="float: right;">ìˆ˜ì •</button>
                </div>
                <p>ì„ ì§€ì›</p>
                <p>ì˜¤ëŠ˜ ì €ë… ë©”ë‰´ ì¶”ì²œí•´ ì£¼ì‹­ì‡¼!</p>
            </li> -->
        </ul>
    </div>
    <div class="commentForm">
        <div class="commentNickPw">
            <div class="nickname">
                <label for="nickname">Nickname:</label>
                <input type="text" name="nickname" id="nickname" required>
            </div>
            <div class="pw">
                <label for="pw">PW:</label>
                <input type="text" name="pw" id="pw" required>
            </div>
        </div>
        <div class="commentUp">
            <div class="comment">
                <label for="comment"></label>
                <input id="comment" type="text" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”."
                    style="width: 95%;height: 40px;font-size: 18px;">
            </div>
            <button id="postingBtn" type="button" button class="button"><span class="inner"><strong>ëŒ“ê¸€
                        ë“±ë¡</strong></span></button>
        </div>
    </div>
</body>
<script>
    $(function () {
        // Vars
        var pointsA = [],
            pointsB = [],
            $canvas = null,
            canvas = null,
            context = null,
            vars = null,
            points = 8,
            viscosity = 20,
            mouseDist = 70,
            damping = 0.05,
            showIndicators = false;
        mouseX = 0,
            mouseY = 0,
            relMouseX = 0,
            relMouseY = 0,
            mouseLastX = 0,
            mouseLastY = 0,
            mouseDirectionX = 0,
            mouseDirectionY = 0,
            mouseSpeedX = 0,
            mouseSpeedY = 0;

        /**
         * Get mouse direction
         */
        function mouseDirection(e) {
            if (mouseX < e.pageX)
                mouseDirectionX = 1;
            else if (mouseX > e.pageX)
                mouseDirectionX = -1;
            else
                mouseDirectionX = 0;

            if (mouseY < e.pageY)
                mouseDirectionY = 1;
            else if (mouseY > e.pageY)
                mouseDirectionY = -1;
            else
                mouseDirectionY = 0;

            mouseX = e.pageX;
            mouseY = e.pageY;

            relMouseX = (mouseX - $canvas.offset().left);
            relMouseY = (mouseY - $canvas.offset().top);
        }
        $(document).on('mousemove', mouseDirection);

        /**
         * Get mouse speed
         */
        function mouseSpeed() {
            mouseSpeedX = mouseX - mouseLastX;
            mouseSpeedY = mouseY - mouseLastY;

            mouseLastX = mouseX;
            mouseLastY = mouseY;

            setTimeout(mouseSpeed, 50);
        }
        mouseSpeed();

        /**
         * Init button
         */
        function initButton() {
            // Get button
            var button = $('.button');
            var buttonWidth = button.width();
            var buttonHeight = button.height();

            // Create canvas
            $canvas = $('<canvas></canvas>');
            button.append($canvas);

            canvas = $canvas.get(0);
            canvas.width = buttonWidth + 100;
            canvas.height = buttonHeight + 100;
            context = canvas.getContext('2d');

            // Add points

            var x = buttonHeight / 2;
            for (var j = 1; j < points; j++) {
                addPoints((x + ((buttonWidth - buttonHeight) / points) * j), 0);
            }
            addPoints(buttonWidth - buttonHeight / 5, 0);
            addPoints(buttonWidth + buttonHeight / 10, buttonHeight / 2);
            addPoints(buttonWidth - buttonHeight / 5, buttonHeight);
            for (var j = points - 1; j > 0; j--) {
                addPoints((x + ((buttonWidth - buttonHeight) / points) * j), buttonHeight);
            }
            addPoints(buttonHeight / 5, buttonHeight);

            addPoints(-buttonHeight / 10, buttonHeight / 2);
            addPoints(buttonHeight / 5, 0);
            // addPoints(x, 0);
            // addPoints(0, buttonHeight/2);

            // addPoints(0, buttonHeight/2);
            // addPoints(buttonHeight/4, 0);

            // Start render
            renderCanvas();
        }

        /**
         * Add points
         */
        function addPoints(x, y) {
            pointsA.push(new Point(x, y, 1));
            pointsB.push(new Point(x, y, 2));
        }

        /**
         * Point
         */
        function Point(x, y, level) {
            this.x = this.ix = 50 + x;
            this.y = this.iy = 50 + y;
            this.vx = 0;
            this.vy = 0;
            this.cx1 = 0;
            this.cy1 = 0;
            this.cx2 = 0;
            this.cy2 = 0;
            this.level = level;
        }

        Point.prototype.move = function () {
            this.vx += (this.ix - this.x) / (viscosity * this.level);
            this.vy += (this.iy - this.y) / (viscosity * this.level);

            var dx = this.ix - relMouseX,
                dy = this.iy - relMouseY;
            var relDist = (1 - Math.sqrt((dx * dx) + (dy * dy)) / mouseDist);

            // Move x
            if ((mouseDirectionX > 0 && relMouseX > this.x) || (mouseDirectionX < 0 && relMouseX < this.x)) {
                if (relDist > 0 && relDist < 1) {
                    this.vx = (mouseSpeedX / 4) * relDist;
                }
            }
            this.vx *= (1 - damping);
            this.x += this.vx;

            // Move y
            if ((mouseDirectionY > 0 && relMouseY > this.y) || (mouseDirectionY < 0 && relMouseY < this.y)) {
                if (relDist > 0 && relDist < 1) {
                    this.vy = (mouseSpeedY / 4) * relDist;
                }
            }
            this.vy *= (1 - damping);
            this.y += this.vy;
        };


        /**
         * Render canvas
         */
        function renderCanvas() {
            // rAF
            rafID = requestAnimationFrame(renderCanvas);

            // Clear scene
            context.clearRect(0, 0, $canvas.width(), $canvas.height());
            context.fillStyle = '#fff';
            context.fillRect(0, 0, $canvas.width(), $canvas.height());

            // Move points
            for (var i = 0; i <= pointsA.length - 1; i++) {
                pointsA[i].move();
                pointsB[i].move();
            }

            // Create dynamic gradient
            var gradientX = Math.min(Math.max(mouseX - $canvas.offset().left, 0), $canvas.width());
            var gradientY = Math.min(Math.max(mouseY - $canvas.offset().top, 0), $canvas.height());
            var distance = Math.sqrt(Math.pow(gradientX - $canvas.width() / 2, 2) + Math.pow(gradientY - $canvas.height() / 2, 2)) / Math.sqrt(Math.pow($canvas.width() / 2, 2) + Math.pow($canvas.height() / 2, 2));

            var gradient = context.createRadialGradient(gradientX, gradientY, 300 + (300 * distance), gradientX, gradientY, 0);
            gradient.addColorStop(0, '#102ce5');
            gradient.addColorStop(1, '#E406D6');

            // Draw shapes
            var groups = [pointsA, pointsB]

            for (var j = 0; j <= 1; j++) {
                var points = groups[j];

                if (j == 0) {
                    // Background style
                    context.fillStyle = '#1CE2D8';
                } else {
                    // Foreground style
                    context.fillStyle = gradient;
                }

                context.beginPath();
                context.moveTo(points[0].x, points[0].y);

                for (var i = 0; i < points.length; i++) {
                    var p = points[i];
                    var nextP = points[i + 1];
                    var val = 30 * 0.552284749831;

                    if (nextP != undefined) {
                        // if (nextP.ix > p.ix && nextP.iy < p.iy) {
                        //  p.cx1 = p.x;
                        //  p.cy1 = p.y-val;
                        //  p.cx2 = nextP.x-val;
                        //  p.cy2 = nextP.y;
                        // } else if (nextP.ix > p.ix && nextP.iy > p.iy) {
                        //  p.cx1 = p.x+val;
                        //  p.cy1 = p.y;
                        //  p.cx2 = nextP.x;
                        //  p.cy2 = nextP.y-val;
                        // }  else if (nextP.ix < p.ix && nextP.iy > p.iy) {
                        //  p.cx1 = p.x;
                        //  p.cy1 = p.y+val;
                        //  p.cx2 = nextP.x+val;
                        //  p.cy2 = nextP.y;
                        // } else if (nextP.ix < p.ix && nextP.iy < p.iy) {
                        //  p.cx1 = p.x-val;
                        //  p.cy1 = p.y;
                        //  p.cx2 = nextP.x;
                        //  p.cy2 = nextP.y+val;
                        // } else {

                        p.cx1 = (p.x + nextP.x) / 2;
                        p.cy1 = (p.y + nextP.y) / 2;
                        p.cx2 = (p.x + nextP.x) / 2;
                        p.cy2 = (p.y + nextP.y) / 2;

                        context.bezierCurveTo(p.x, p.y, p.cx1, p.cy1, p.cx1, p.cy1);
                        //  continue;
                        // }

                        // context.bezierCurveTo(p.cx1, p.cy1, p.cx2, p.cy2, nextP.x, nextP.y);
                    } else {
                        nextP = points[0];
                        p.cx1 = (p.x + nextP.x) / 2;
                        p.cy1 = (p.y + nextP.y) / 2;

                        context.bezierCurveTo(p.x, p.y, p.cx1, p.cy1, p.cx1, p.cy1);
                    }
                }

                // context.closePath();
                context.fill();
            }

            if (showIndicators) {
                // Draw points
                context.fillStyle = '#000';
                context.beginPath();
                for (var i = 0; i < pointsA.length; i++) {
                    var p = pointsA[i];

                    context.rect(p.x - 1, p.y - 1, 2, 2);
                }
                context.fill();

                // Draw controls
                context.fillStyle = '#f00';
                context.beginPath();
                for (var i = 0; i < pointsA.length; i++) {
                    var p = pointsA[i];

                    context.rect(p.cx1 - 1, p.cy1 - 1, 2, 2);
                    context.rect(p.cx2 - 1, p.cy2 - 1, 2, 2);
                }
                context.fill();
            }
        }

        // Init
        initButton();
    });
    //Resources
</script>

</html>